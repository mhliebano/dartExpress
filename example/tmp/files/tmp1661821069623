import 'package:flutter/widgets.dart';
import 'package:kipu/src/models/fields_mod.dart';
import 'package:kipu/src/services/database_ser.dart';

class FieldPro with ChangeNotifier {
  List<FieldMod> _list = [];
  List<FieldMod> get listFields => _list;
  set listFields(List<FieldMod> l) {
    _list = l;
    notifyListeners();
  }

  int _selectedField = -1;
  int get selectedFieldIndex => _selectedField;
  set selectedFieldIndex(int i) {
    _selectedField = i;
    notifyListeners();
  }

  void addSector(FieldMod field) async {
    if (_selectedField == -1) {
      field.id = await DataBaseSer.saveField(field);
      _list.add(field);
    } else {
      field.id = _list[_selectedField].id;
      _list[_selectedField] = field;
      DataBaseSer.updateField(field);
    }
    notifyListeners();
  }

  void deleteField(int index) {
    DataBaseSer.deleteField(_list[index].id!);
    _list.removeAt(index);
    notifyListeners();
  }
}